import{j as s,a as R,F as b}from"./index-e8b020c1.js";import{d as n,h as k,e as v,ad as B,O as H,K as j}from"./elements-7fcf5525.js";import{o as _,m as q}from"./app-fc3be005.js";import{u as w,F as U}from"./index.esm-70abc844.js";import{o as y}from"./index.esm-c689e26d.js";import{u as K,a as W,S as X,F as z,s as T,b as J,v as O,A as Y}from"./progress-bar-v2-c219d302.js";import{P as Z}from"./page-layout-787fd5b1.js";import{u as $,a as Q}from"./scroll-to-bottom-fab-efb6dcd3.js";import"./axios-7a17aed4.js";import{u as ee,a as te}from"./hooks-05c80420.js";import{u as re}from"./use-get-admin-setup-metadata-44fda336.js";import{D as se}from"./error-messages-27b293ab.js";import"./extended-yup-validation-81b0cc3b.js";import"./regex-aa179d17.js";import"./options-21b6589e.js";import"./input-error-d2d32890.js";import"./department-mapping-99823d46.js";import"./index-f4612fa3.js";import"./use-user-agent-7653ecfd.js";import"./generate-1a9ed554.js";import"./routes-4ccd8c9c.js";import"./middleware-a8d06d07.js";import"./queries-keys-1e9a6485.js";const V={contact:{title:"",marketingConsent:"notAsked",primaryAddress:{countryId:"GB"}},applicant:{departmentId:"G",marketingMode:"",externalArea:{type:"acres"},locationType:"",buying:{tenure:[]}}},u=(t,r)=>t||(r!=null&&r.rentFrequency?q.merge(V,{applicant:{renting:{rentFrequency:r==null?void 0:r.rentFrequency}}}):V),Ve=()=>{var f,S,F,A;const{formData:t}=$(),{resetStoresValues:r}=Q(),{setTailoredQuestions:C}=ee(),{setStepsHeader:x}=te(),[m,c]=n.useState(t?"4":"1"),p=K(),d=W(),e=re(),a=w({mode:"all",defaultValues:u(t,(S=(f=e==null?void 0:e.data)==null?void 0:f.metadata)==null?void 0:S.defaultOptions),resolver:y(Y)}),[G,I]=n.useState(t),{removePopStateListener:M}=_();n.useEffect(()=>{var o,i;t&&(I(t),r(),c("4"),a.reset(u(t,(i=(o=e==null?void 0:e.data)==null?void 0:o.metadata)==null?void 0:i.defaultOptions),{keepDefaultValues:!0}),M("summary"))},[t]),n.useEffect(()=>{var o,i,E,D,h,L,N,P;if((i=(o=e==null?void 0:e.data)==null?void 0:o.metadata)!=null&&i.tailoredQuestions){const l=e.data.metadata.tailoredQuestions;C(l)}if((D=(E=e==null?void 0:e.data)==null?void 0:E.metadata)!=null&&D.stepsHeader){const l=e.data.metadata.stepsHeader;x(l)}(L=(h=e==null?void 0:e.data)==null?void 0:h.metadata)!=null&&L.defaultOptions&&a.reset(u(G,(P=(N=e==null?void 0:e.data)==null?void 0:N.metadata)==null?void 0:P.defaultOptions),{keepDefaultValues:!0})},[e.isLoading]);const g=p.isError||d.isError?((F=p.error)==null?void 0:F.readableMessage)??((A=d.error)==null?void 0:A.readableMessage)??se.DEFAULT:"";return s(Z,{prefixTestId:"rp",children:p.isLoading||d.isLoading||e!=null&&e.isLoading?s(k,{label:"Loading",fullPage:!0}):g?s(v,{isInline:!0,isExpanded:!0,intent:"danger",className:B,children:g}):R(b,{children:[R("div",{className:X,children:[s(H,{children:"New Registration"}),s(z,{currentStep:+m,totalStep:T.length,"data-testid":"rp-progress-bar"})]}),s("form",{className:J,onChange:O({getValues:a.getValues,trigger:a.trigger,stepState:[m,c]}),"data-testid":"rp-form",children:s(U,{...a,children:s(j,{steps:T,selectedStep:m})})})]})})};export{Ve as default};
