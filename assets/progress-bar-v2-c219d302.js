import{c as z,a as C,d as Me,e as P}from"./index.esm-c689e26d.js";import"./extended-yup-validation-81b0cc3b.js";import{E as o}from"./error-messages-27b293ab.js";import{a as u,j as t,F as ce}from"./index-e8b020c1.js";import{j as k,k as w,l as T,n as R,v as q,a5 as ae,I as Ne,d as O,af as Ye,D as ee,ad as Te,ag as pe,C as de,r as te,o as Y,ah as ze,ai as We,aj as je,u as Qe,h as $e,ak as De,E as K,al as He,V as Z,am as Be,x as Xe,a6 as Ke,y as Ze,an as Je,ao as et,ap as ie,aq as tt,ar as nt,as as at,at as rt,au as it,av as st,aw as ot}from"./elements-7fcf5525.js";import{v as lt,g as ue,h as me,i as xe,k as _e,w as Le,m as ye,p as ct,j as G,u as pt,c as dt}from"./app-fc3be005.js";import{c as ut,t as mt,b as gt,d as Ve}from"./regex-aa179d17.js";import{u as H,a as ge}from"./hooks-05c80420.js";import{a as D,C as oe,u as ht}from"./index.esm-70abc844.js";import{a as Mt,M as Et,S as ft,b as Rt,R as yt,T as ke}from"./options-21b6589e.js";import{I as W}from"./input-error-d2d32890.js";import{i as Pe,D as Oe}from"./department-mapping-99823d46.js";import{A as Ie}from"./index-f4612fa3.js";import{A as Se,U as Ce}from"./axios-7a17aed4.js";import{u as At}from"./use-user-agent-7653ecfd.js";import{g as bt}from"./generate-1a9ed554.js";import{c as Nt}from"./page-layout-787fd5b1.js";import{u as Tt,a as xt,S as _t}from"./scroll-to-bottom-fab-efb6dcd3.js";import{a as It,R as St}from"./routes-4ccd8c9c.js";const Ee={test:(e,n)=>{var s,d;const a=((d=(s=n.options)==null?void 0:s.context)==null?void 0:d.from)??n.options.from,[r]=a;return!!r.value.homePhone||!!r.value.workPhone||!!r.value.mobilePhone},name:"isAtLeastOneOfPhoneIsFilled",message:o.ONE_OF_SPECIFIC_FIELD_REQUIRED("Phone Number")},fe={test:e=>e===null?!0:`${e}`.length>=11,name:"phones-minimum-length-is-eleven",message:o.MINIMUM_CHARACTER_LENGTH(11)},U={name:"must-be-positive-or-equal-to-zero",test:e=>e==null?!0:Object.is(+e,-0)?!1:+e>=0},Re={test:e=>e==null?!0:ut.test(e)},Ct={name:"internal-area-amount",test:(e,n)=>{var s,d;if(e==null)return!0;const a=((d=(s=n.options)==null?void 0:s.context)==null?void 0:d.from)??n.options.from,r=lt(a,"applicant.internalArea.type").toString();return r==="squareFeet"&&`${e}`.length>6?n.createError({message:o.MAXIMUM_CHARACTER_LENGTH(6)}):r==="squareMetres"&&`${e}`.length>8?n.createError({message:o.MAXIMUM_CHARACTER_LENGTH(8)}):!0}},Ft=z().shape({departmentId:C().required(),marketingMode:C().trim().required(o.FIELD_REQUIRED),locationOptions:Me().min(1,o.ONE_OF_SPECIFIC_FIELD_REQUIRED("Address option")).required(o.ONE_OF_SPECIFIC_FIELD_REQUIRED("Address option")),buying:z().shape({leaseRemaining:z().shape({min:P().transform((e,n)=>n?e:0).nullable().test({...U,message:o.HIGHER_OR_EQUAL_THAN("Min Lease Remaining","0")}).typeError(o.TYPE_ERROR("Number","Min Lease Remaining")).requiredIfTheRelationFieldsNotNull({relatedFields:["applicant.buying.leaseRemaining.min","applicant.buying.leaseRemaining.max"],errMessage:o.BOTH_FIELD_REQUIRED}).minHighNumberValidator({minField:"applicant.buying.leaseRemaining.min",maxField:"applicant.buying.leaseRemaining.max"},o.HIGHER_OR_EQUAL_THAN("Max Lease Remaining","Min Lease Remaining")).maxNumberLength(3),max:P().transform((e,n)=>n?e:0).nullable().test({...U,message:o.HIGHER_OR_EQUAL_THAN("Max Lease Remaining","0")}).typeError(o.TYPE_ERROR("Number","Max Lease Remaining")).requiredIfTheRelationFieldsNotNull({relatedFields:["applicant.buying.leaseRemaining.min","applicant.buying.leaseRemaining.max"],errMessage:o.BOTH_FIELD_REQUIRED}).minHighNumberValidator({minField:"applicant.buying.leaseRemaining.min",maxField:"applicant.buying.leaseRemaining.max"},o.HIGHER_OR_EQUAL_THAN("Max Lease Remaining","Min Lease Remaining")).maxNumberLength(3)}),priceFrom:P().integer(o.TYPE_ERROR("Round Number","Minimum Budget")).transform((e,n)=>e==null||n===null?null:Number(n.toString().replace(/,/g,""))).requiredWhenMarketingModeTypeIs("buying",{errMessage:o.FIELD_REQUIRED}).maxNumberLength(9).maxBudgetMustHigherThanMinBudget(o.LOWER_OR_EQUAL_THAN("Minimum Budget","Maximum Budget")).nullable(),priceTo:P().integer(o.TYPE_ERROR("Round Number","Maximum Budget")).transform((e,n)=>e==null||n===null?null:Number(n.toString().replace(/,/g,""))).requiredWhenMarketingModeTypeIs("buying",{errMessage:o.FIELD_REQUIRED}).maxNumberLength(9).maxBudgetMustHigherThanMinBudget(o.HIGHER_OR_EQUAL_THAN("Maximum Budget","Minimum Budget")).moreThan(0,o.MUST_HIGHER_THAN("Maximum Budget","0")).nullable(),tenure:Me().of(C()).transform(e=>e&&e.length?e:[])}).nullable(),renting:z().shape({rentFrom:P().integer(o.TYPE_ERROR("Round Number","Minimum Budget")).transform((e,n)=>e==null||n===null?null:Number(n.toString().replace(/,/g,""))).requiredWhenMarketingModeTypeIs("renting",{errMessage:o.FIELD_REQUIRED}).maxNumberLength(9).maxBudgetMustHigherThanMinBudget(o.MUST_LOWER_THAN("Minimum Budget","Maximum Budget")).nullable(),rentTo:P().integer(o.TYPE_ERROR("Round Number","Maximum Budget")).transform((e,n)=>e==null||n===null?null:Number(n.toString().replace(/,/g,""))).requiredWhenMarketingModeTypeIs("renting",{errMessage:o.FIELD_REQUIRED}).maxNumberLength(9).maxBudgetMustHigherThanMinBudget(o.MUST_HIGHER_THAN("Maximum Budget","Minimum Budget")).nullable(),rentFrequency:C().trim().requiredWhenMarketingModeTypeIs("renting",{errMessage:o.FIELD_REQUIRED}).nullable(),term:C()}).nullable(),externalArea:z().shape({amountFrom:C().trim().transform((e,n)=>isNaN(n)||n==null?"":n.toString()).nullable().test({...U,message:o.HIGHER_OR_EQUAL_THAN("Minimum size","0")}).requiredIfTheRelationFieldsNotNull({errMessage:o.FIELD_REQUIRED,relatedFields:["applicant.externalArea.amountFrom","applicant.externalArea.amountTo"]}).typeError(o.TYPE_ERROR("Number","Minimum size")).higherFieldMustBeHighThanLowerField({errMessage:o.MUST_LOWER_THAN("Minimum size","Maximum size"),relatedFields:["applicant.externalArea.amountFrom","applicant.externalArea.amountTo"]}).max(6,o.MAXIMUM_DIGIT_LENGTH(6)),amountTo:C().trim().transform((e,n)=>isNaN(n)||n==null?"":n.toString()).nullable().test({...U,message:o.HIGHER_OR_EQUAL_THAN("Maximum size","0")}).requiredIfTheRelationFieldsNotNull({errMessage:o.FIELD_REQUIRED,relatedFields:["applicant.externalArea.amountFrom","applicant.externalArea.amountTo"]}).typeError(o.TYPE_ERROR("Number","Maximum size")).higherFieldMustBeHighThanLowerField({errMessage:o.MUST_HIGHER_THAN("Maximum size","Minimum size"),relatedFields:["applicant.externalArea.amountFrom","applicant.externalArea.amountTo"]}).max(6,o.MAXIMUM_DIGIT_LENGTH(6))}).nullable(),internalArea:z().shape({type:C().transform(e=>e===""||e===void 0||e===null?null:e).nullable().typeError(o.TYPE_ERROR("Text","Internal Area Type")).requiredIfTheRelationFieldsNotNull({errMessage:o.FIELD_REQUIRED,relatedFields:["applicant.internalArea.type","applicant.internalArea.amount"]}),amount:P().noWhitespace().transform((e,n)=>isNaN(e)&&n===""?null:e).nullable().typeError(o.TYPE_ERROR("Number","Amount")).test({...U,message:o.TYPE_ERROR("Number","Amount")}).test(Ct).requiredIfTheRelationFieldsNotNull({errMessage:o.FIELD_REQUIRED,relatedFields:["applicant.internalArea.type","applicant.internalArea.amount"]})}).nullable(),type:Me().min(1,o.ONE_OF_SPECIFIC_FIELD_REQUIRED("option")).required(o.ONE_OF_SPECIFIC_FIELD_REQUIRED("option")),bedroomsMin:P().transform((e,n)=>n===""||n===null?0:e).nullable().typeError(o.TYPE_ERROR("Number","Bedroom Min")).test({...U,message:o.HIGHER_OR_EQUAL_THAN("Bedroom Min","0")}).maxNumberLength(3),bedroomsMax:P().transform((e,n)=>n===""||n===null?0:e).nullable().typeError(o.TYPE_ERROR("Number","Bedroom Max")).test({...U,message:o.HIGHER_OR_EQUAL_THAN("Bedroom Max","0")}).maxNumberLength(3),receptionsMin:P().transform((e,n)=>n===""||n===null?0:e).nullable().typeError(o.TYPE_ERROR("Number","Reception Min")).test({...U,message:o.HIGHER_OR_EQUAL_THAN("Reception Min","0")}).maxNumberLength(3),receptionsMax:P().transform((e,n)=>n===""||n===null?0:e).nullable().typeError(o.TYPE_ERROR("Number","Reception Max")).test({...U,message:o.HIGHER_OR_EQUAL_THAN("Reception Max","0")}).maxNumberLength(3),bathroomsMin:P().transform((e,n)=>n===""||n===null?0:e).nullable().typeError(o.TYPE_ERROR("Number","Bathroom Min")).test({...U,message:o.HIGHER_OR_EQUAL_THAN("Bathroom Min","0")}).maxNumberLength(3),bathroomsMax:P().transform((e,n)=>n===""||n===null?0:e).nullable().typeError(o.TYPE_ERROR("Number","Bathroom Max")).test({...U,message:o.HIGHER_OR_EQUAL_THAN("Bathroom Max","0")}).maxNumberLength(3)}),Dt=z().shape({email:C().trim().email(o.SPECIFIC_INVALID_PATTERN("email address")).required(o.FIELD_REQUIRED).typeError(o.FIELD_REQUIRED),title:C().required(o.FIELD_REQUIRED).trim().max(15,({max:e})=>o.MAXIMUM_CHARACTER_LENGTH(e)).nullable().matches(mt,o.SPECIFIC_INVALID_PATTERN("Title")),forename:C().trim().required(o.FIELD_REQUIRED).max(20,({max:e})=>o.MAXIMUM_CHARACTER_LENGTH(e)),surname:C().trim().required(o.FIELD_REQUIRED).max(45,({max:e})=>o.MAXIMUM_CHARACTER_LENGTH(e)),homePhone:C().transform(e=>e===""?null:e).trim().typeError(o.SPECIFIC_INVALID_PATTERN("phone number")).test({...Re,message:o.TYPE_ERROR("Number","Home Phone")}).test(fe).test(Ee).nullable(),workPhone:C().transform(e=>e===""?null:e).trim().typeError(o.SPECIFIC_INVALID_PATTERN("phone number")).test({...Re,message:o.TYPE_ERROR("Number","Work Phone")}).test(fe).test(Ee).nullable(),mobilePhone:C().transform(e=>e===""?null:e).trim().typeError(o.SPECIFIC_INVALID_PATTERN("phone number")).test({...Re,message:o.TYPE_ERROR("Number","Mobile Phone")}).test(fe).test(Ee).nullable(),primaryAddress:z().shape({buildingName:C().trim().max(35,({max:e})=>o.MAXIMUM_CHARACTER_LENGTH(e)).nullable(),buildingNumber:C().trim().max(8,({max:e})=>o.MAXIMUM_CHARACTER_LENGTH(e)).nullable(),line1:C().trim().max(35,({max:e})=>o.MAXIMUM_CHARACTER_LENGTH(e)).nullable(),postcode:C().trim().required(o.FIELD_REQUIRED).max(8,({max:e})=>o.MAXIMUM_CHARACTER_LENGTH(e)).nullable()}).nullable()}),_n=z().shape({contact:Dt,applicant:Ft}),Lt=()=>{var a;const{register:e}=D(),{tailoredQuestions:n}=H();return u("div",{"data-testid":"mc-section-wrapper",className:"el-mt9",children:[t(k,{"data-testid":"mc-text-title",children:(a=n==null?void 0:n.contact)==null?void 0:a.marketingConsent}),t(w,{children:t(T,{children:t(R,{children:u(q,{...e("contact.marketingConsent",{setValueAs:r=>r===""?null:r}),"data-testid":"mc-field-marketing-consent",className:"el-wfull",children:[t("option",{value:"",disabled:!0,children:"Select Consent Type"}),Mt.map(r=>t("option",{value:r.id,children:r.value},r.id))]})})})})]})},Pt=()=>{var s,d,p;const{tailoredQuestions:e}=H(),{register:n,clearErrors:a,formState:{errors:r}}=D();return u("div",{"data-testid":"mm-section-wrapper",className:"el-mt9",children:[t(k,{"data-testid":"mm-text-title",children:(s=e==null?void 0:e.applicant)==null?void 0:s.marketingMode}),t(w,{children:t(T,{children:u(R,{children:[u(q,{...n("applicant.marketingMode",{onChange:()=>{a(["applicant.buying","applicant.renting"])}}),"data-testid":"mm-field-marketing-mode",className:"el-wfull",children:[t("option",{value:"",disabled:!0,children:"Select Sales or Lettings*"}),Et.map(l=>t("option",{value:l.id,children:l.value},l.id))]}),t(W,{message:(p=(d=r==null?void 0:r.applicant)==null?void 0:d.marketingMode)==null?void 0:p.message})]})})})]})},Ot=()=>{var d,p,l,i,c,g,M,f,h;const{register:e,formState:{errors:n},trigger:a}=D(),{tailoredQuestions:r}=H(),s=()=>{a(["contact.workPhone","contact.homePhone","contact.mobilePhone"])};return u("div",{"data-testid":"contact-section-wrapper",className:ae,children:[t(k,{"data-testid":"contact-text-title",children:(d=r==null?void 0:r.contact)==null?void 0:d.contactDetail}),u(w,{children:[t(T,{children:t(R,{id:"email",type:"text","data-testid":"email",placeholder:"Email*",...e("contact.email"),errorMessage:(l=(p=n.contact)==null?void 0:p.email)==null?void 0:l.message})}),t(T,{children:t(R,{id:"mobilePhone","data-testid":"mobilePhone",type:"text",placeholder:"Mobile Number*",...e("contact.mobilePhone",{onChange:s,setValueAs:E=>E===""?null:E}),errorMessage:(c=(i=n.contact)==null?void 0:i.mobilePhone)==null?void 0:c.message})}),t(T,{children:t(R,{id:"homePhone","data-testid":"homePhone",type:"text",placeholder:"Home Phone*",...e("contact.homePhone",{onChange:s,setValueAs:E=>E===""?null:E}),errorMessage:(M=(g=n.contact)==null?void 0:g.homePhone)==null?void 0:M.message})}),t(T,{children:t(R,{id:"workPhone","data-testid":"workPhone",type:"text",placeholder:"Work Phone*",...e("contact.workPhone",{onChange:s,setValueAs:E=>E===""?null:E}),errorMessage:(h=(f=n.contact)==null?void 0:f.workPhone)==null?void 0:h.message})})]})]})};const we={formWrapper:"fhip7cx",titleInput:"te2jsil"},wt=()=>{var p,l,i,c,g,M,f;const{register:e,formState:{errors:n}}=D(),{tailoredQuestions:a}=H(),{isMobile:r,isTablet:s}=Ne(),d=r||s;return u("div",{"data-testid":"name-section-wrapper",children:[t(k,{"data-testid":"ns-text-title",children:(p=a==null?void 0:a.contact)==null?void 0:p.name}),u(w,{className:we.formWrapper,children:[t(T,{children:t(R,{...e("contact.title"),className:d?"el-wfull":we.titleInput,placeholder:"Title*","data-testid":"ns-field-title",type:"text",errorMessage:(i=(l=n.contact)==null?void 0:l.title)==null?void 0:i.message})}),t(T,{children:t(R,{...e("contact.forename"),placeholder:"Forename*","data-testid":"ns-field-forename",type:"text",errorMessage:(g=(c=n.contact)==null?void 0:c.forename)==null?void 0:g.message})}),t(T,{children:t(R,{...e("contact.surname"),placeholder:"Surname*","data-testid":"ns-field-surname",type:"text",errorMessage:(f=(M=n.contact)==null?void 0:M.surname)==null?void 0:f.message})})]})]})},Ht=()=>{var p,l,i,c,g,M,f,h,E,A,x,N,S;const{register:e,formState:{errors:n},watch:a}=D(),{tailoredQuestions:r}=H(),s=a("contact.primaryAddress.countryId"),d=O.useMemo(()=>{const _=s;if(_)return Pe.all().find(m=>m.alpha2.toLowerCase().includes(_.toLowerCase()))},[s]);return u("div",{"data-testid":"address-section-wrapper",className:ae,children:[t(k,{"data-testid":"address-text-title",children:(p=r==null?void 0:r.contact)==null?void 0:p.address}),u(w,{children:[t(T,{children:t(R,{id:"buildingName","data-testid":"buildingName",type:"text",placeholder:"House Name / Flat",...e("contact.primaryAddress.buildingName"),errorMessage:(c=(i=(l=n.contact)==null?void 0:l.primaryAddress)==null?void 0:i.buildingName)==null?void 0:c.message})}),t(T,{children:t(R,{id:"buildingNumber","data-testid":"buildingNumber",type:"text",placeholder:"House Number",...e("contact.primaryAddress.buildingNumber"),errorMessage:(f=(M=(g=n.contact)==null?void 0:g.primaryAddress)==null?void 0:M.buildingNumber)==null?void 0:f.message})}),t(T,{children:t(R,{id:"addressLine1","data-testid":"addressLine1",type:"text",placeholder:"Address Line 1",...e("contact.primaryAddress.line1"),errorMessage:(A=(E=(h=n.contact)==null?void 0:h.primaryAddress)==null?void 0:E.line1)==null?void 0:A.message})}),t(T,{children:t(R,{id:"postcode","data-testid":"postcode",type:"text",placeholder:"Postcode*",...e("contact.primaryAddress.postcode"),errorMessage:(S=(N=(x=n.contact)==null?void 0:x.primaryAddress)==null?void 0:N.postcode)==null?void 0:S.message})}),t(T,{children:t(Ye,{id:"countryId","data-testid":"countryId",placeholder:"Country",defaultVal:d,getResults:_=>{const m=Pe.all(),b=m.filter(L=>L.country.toLowerCase().includes(_.toLowerCase()));return Promise.resolve(b.length>0&&_?b:m)},getResultLabel:_=>_.country,getResultValue:_=>_.alpha2,...e("contact.primaryAddress.countryId")})})]})]})},Bt=()=>{const{stepsHeader:e}=ge();return u("div",{"data-testid":"step-one-wrapper",children:[t("div",{className:ee(Te,pe),children:t(de,{hasNoMargin:!0,hasBoldText:!0,"data-testid":"step-one-title",children:e==null?void 0:e.stepOne})}),t(wt,{}),t(Ot,{}),t(Ht,{}),t(Pt,{}),t(Lt,{})]})},Vt=async e=>{try{const{data:n}=await Se.get(Ce.CONFIGURATION_TYPES,{params:{type:["applicantStatuses","buyingPositions","buyingReasons","rentingPositions"]},headers:{Authorization:`Bearer ${e==null?void 0:e.accessToken}`}});return n}catch(n){throw n instanceof Ie?_e(n):new Error(n)}},kt=()=>{const e=ue(),{connectSession:n}=me(e);return xe(["configuration"],{queryFn:()=>Vt(n),staleTime:1e3*60*60,enabled:!!n})};const Ue="i646pjl",Ge="ikij7s1",Ut="p7l5q86",se={formLayout:"fjfq3xw",desiredMovingDateForSafari:"d1cv8qcb",desiredMovingDateNotHaveValue:"d1kijygy",desiredMovingDateHaveValue:"dmwp7na",visibilityHidden:"v1597mul"},Gt=(e,n)=>{var s;const r={...n,...{hardcodedSellingPosition:ft,hardcodedSellingStatus:Rt}};return(s=r==null?void 0:r[e])==null?void 0:s.map(d=>t("option",{value:d.id,children:d.value},d.id))},vt=()=>{var f;const{tailoredQuestions:e}=H(),{isMobile:n,isTablet:a}=Ne(),{register:r,watch:s,setValue:d}=D(),{data:p}=kt(),{browser:l}=At(),i=s("applicant.marketingMode")==="buying",c=s("applicant.sellingPosition")==="sellingWithOtherAgent",g=h=>Gt(h,p);te.useEffect(()=>{c||d("applicant.sellingStatus","")},[c]);const M=!!s("applicant.renting.moveDate");return u("div",{"data-testid":"status-section-wrapper",className:"el-mt9",children:[t(k,{"data-testid":"status-text-title",children:(f=e==null?void 0:e.applicant)==null?void 0:f.applicantStatus}),u(w,{className:se.formLayout,children:[t(T,{children:u(R,{children:[!a&&!n&&t(Y,{className:se.visibilityHidden,children:"Applicant Status"}),u(q,{className:"el-wfull","data-testid":"status-field-applicant-status",...r("applicant.statusId",{setValueAs:h=>h===""?null:h}),children:[t("option",{value:"",children:"Select Applicant Status"}),g("applicantStatuses")]})]})}),t(T,{children:t(R,{"data-testid":"status-field-a-pot-client",...r("applicant.potentialClient"),id:"aPotClient",label:"Potential Client",type:"checkbox"})}),t(T,{children:t(R,{children:u(q,{className:"el-wfull","data-testid":"status-field-selling-pos",...r("applicant.sellingPosition",{setValueAs:h=>h===""?null:h}),children:[t("option",{value:"",children:"Selling Position"}),g("hardcodedSellingPosition")]})})}),t(T,{children:t(R,{children:u(q,{disabled:!c,className:"el-wfull","data-testid":"status-field-selling-status",...r("applicant.sellingStatus",{setValueAs:h=>h===""?null:h}),children:[t("option",{value:"",children:"Selling Status"}),g("hardcodedSellingStatus")]})})}),i?u(ce,{children:[t(T,{children:t(R,{children:u(q,{className:"el-wfull","data-testid":"status-field-applicant-buying-pos",...r("applicant.buying.positionId",{setValueAs:h=>h===""?null:h}),children:[t("option",{value:"",children:"Buying Position"}),g("buyingPositions")]})})}),t(T,{children:t(R,{children:u(q,{className:"el-wfull","data-testid":"status-field-applicant-buying-reason",...r("applicant.buying.reasonId",{setValueAs:h=>h===""?null:h}),children:[t("option",{value:"",children:"Buying Reason"}),g("buyingReasons")]})})})]}):u(ce,{children:[t(T,{className:ze,children:t(R,{children:u(q,{className:"el-wfull","data-testid":"status-field-applicant-renting-pos",...r("applicant.renting.positionId",{setValueAs:h=>h===""?null:h}),children:[t("option",{value:"",children:"Renting Position"}),g("rentingPositions")]})})}),t(T,{children:t(R,{type:"date","data-testid":"move-date",label:"Desired Moving Date",placeholder:M?"":"Select Date",className:ee(l.isSafari&&se.desiredMovingDateForSafari,M?se.desiredMovingDateHaveValue:se.desiredMovingDateNotHaveValue),...r("applicant.renting.moveDate")})})]})]})]})};function ne({control:e,...n}){const a=te.useMemo(()=>bt({prefix:"c-input-m2"}),[]),r={...n},s=Le("Min",r),d=Le("Max",r),p=i=>{const c=i.target.value;return c===""||c===null?null:Number.isFinite(+c)?+c:c},l=i=>{if(i){const c=i.toLocaleString("fullwide",{useGrouping:!1});return s.name.includes("priceFrom")||s.name.includes("rentFrom")||d.name.includes("priceTo")||d.name.includes("rentTo")?new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",currencyDisplay:"code",minimumFractionDigits:0,maximumFractionDigits:0}).format(+i).replace("GBP","").trim():c}return i};return u(ce,{children:[t(T,{children:t(oe,{control:e,name:s.name,render:({field:{value:i,...c}})=>{const g=M=>{const f=(s==null?void 0:s.onChangeTransform)??p;s!=null&&s.onChange&&s.onChange(M),c.onChange(f(M)),c.onBlur()};return t(R,{"data-testid":"c-input-min-field",...c,...ye.omit(s,["onChangeTransform"]),id:a,onChange:g,defaultValue:l(i),onBlur:g})}})}),t(T,{children:t(oe,{control:e,name:d.name,render:({field:{value:i,...c}})=>{const g=M=>{const f=(d==null?void 0:d.onChangeTransform)??p;d!=null&&d.onChange&&d.onChange(M),c.onChange(f(M)),c.onBlur()};return t(R,{"data-testid":"c-input-max-field",...c,...ye.omit(d,["onChangeTransform"]),onChange:g,defaultValue:l(i),onBlur:g})}})})]})}const qt=()=>{var f,h,E,A,x,N,S,_,m,b,L,F,j,Q,$,X;const{tailoredQuestions:e}=H(),{control:n,watch:a,register:r,formState:{errors:s},trigger:d}=D(),p=a("applicant.marketingMode")==="buying",{isMobile:l,isTablet:i}=Ne(),c=l||i,g=async()=>{p?await d(["applicant.buying.priceFrom","applicant.buying.priceTo"]):await d(["applicant.renting.rentFrom","applicant.renting.rentTo"])},M=B=>{let y=B.target.value.replace(gt,"").toLowerCase();return y.includes("k")?y=y.replace("k","000"):y.includes("m")&&(y=y.replace("m","000000")),y=new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",currencyDisplay:"code",minimumFractionDigits:0,maximumFractionDigits:0}).format(+y).replace("GBP","").trim(),B.target.value=y,Number.isFinite(+y)?+y:y};return u("div",{"data-testid":"budget-section-wrapper",className:"el-mt9",children:[t(k,{"data-testid":"budget-text-title",children:(f=e==null?void 0:e.applicant)==null?void 0:f.budget}),u(w,{children:[t(ne,{control:n,nameMin:p?"applicant.buying.priceFrom":"applicant.renting.rentFrom",nameMax:p?"applicant.buying.priceTo":"applicant.renting.rentTo",iconMin:"poundSystem",iconMax:"poundSystem",placeholderMin:"From*",placeholderMax:"To*",onChangeMin:g,onChangeTransformMin:M,onChangeTransformMax:M,onChangeMax:g,"data-testidMin":`budget-field-${p?"buying":"renting"}-min`,"data-testidMax":`budget-field-${p?"buying":"renting"}-max`,className:ee(c&&We),errorMessageMin:p?(A=(E=(h=s.applicant)==null?void 0:h.buying)==null?void 0:E.priceFrom)==null?void 0:A.message:(S=(N=(x=s.applicant)==null?void 0:x.renting)==null?void 0:N.rentFrom)==null?void 0:S.message,errorMessageMax:p?(b=(m=(_=s.applicant)==null?void 0:_.buying)==null?void 0:m.priceTo)==null?void 0:b.message:(j=(F=(L=s.applicant)==null?void 0:L.renting)==null?void 0:F.rentTo)==null?void 0:j.message}),!p&&u(T,{children:[u(q,{className:"el-wfull","data-testid":"budget-field-rent-frequency",...r("applicant.renting.rentFrequency"),children:[t("option",{value:"",children:"Select Rent Frequency*"}),yt.map(B=>t("option",{value:B.id,children:B.value},B.id))]}),t(W,{message:(X=($=(Q=s.applicant)==null?void 0:Q.renting)==null?void 0:$.rentFrequency)==null?void 0:X.message})]})]})]})};const J="m1t4qblk";function Yt({data:e,disabled:n,onInputChange:a,isLoading:r,onPreClick:s,onPreSelectFn:d,name:p,isSearchResultNotFound:l,errorMessage:i,sectionTestId:c}){const g=D(),M=O.useRef(null),f=A=>{const x=A.currentTarget.value;let N=[];x&&(N=x.split(",")),d&&d(N),g.setValue(p,N,{shouldDirty:!0}),g.trigger(p)},h=`ms-${p}`,E=A=>{s&&s(A),setTimeout(()=>{M.current&&M.current.focus()},0)};return u(T,{"data-testid":c,className:ee(Ue,J),children:[n&&t("div",{className:Ge,onClick:E}),u(R,{children:[t(je,{"data-testid":"locationOptions-areas",ref:M,disabled:n,type:"search",placeholder:"Find Areas*",onChange:a}),t(Qe,{icon:"searchSystem"})]}),r&&t($e,{"data-testid":"multiselect-loader",className:De}),u(R,{children:[!n&&!!(e!=null&&e.length)&&t(oe,{name:p,control:g.control,render:({field:{value:A,...x}})=>t(K,{...x,disabled:n,defaultValues:A,onChange:f,className:De,id:h,"data-testid":h,options:e})}),t(W,{message:i}),l&&t(W,{message:"Area not found"})]})]})}const ve=async(e,n)=>{try{const{data:a}=await Se.get(Ce.AREAS,{params:e,headers:{Authorization:`Bearer ${n.accessToken}`}});return a}catch(a){throw a instanceof Ie?_e(a):new Error(a)}},zt=(e,n=!1)=>{const a=ue(),{connectSession:r}=me(a);return xe(["areas",e],()=>ve({name:e},r),{enabled:!!r&&!!e&&n,keepPreviousData:!0})},In=()=>{const e=ue(),{connectSession:n}=me(e);return ct({mutationFn:a=>ve({id:a},n)})},Ae="preferred-address-section-wrapper",Wt=()=>{var j,Q,$,X,B,V;const{tailoredQuestions:e}=H(),{control:n,setValue:a,formState:{errors:r},trigger:s,watch:d}=D(),p=d("applicant.locationType"),l=d("applicant.locationOptions"),i=d("choosenArea"),c=()=>l!=null&&l.length?l==null?void 0:l.join(", "):"",[g,M]=O.useState([]),[f,h]=O.useState(""),{data:E,isFetching:A,isSuccess:x}=zt(f,p==="areas"),[N,S]=O.useState(p==="addresses"?c():""),_=O.useRef(null),m=O.useMemo(()=>ye.debounce(y=>{var v;const I=(v=y==null?void 0:y.target)==null?void 0:v.value;h(I)},Nt),[]),b=y=>{const I=y.currentTarget.value;let v;I&&(v=[I]),a("applicant.locationOptions",v,{shouldDirty:!0}),s("applicant.locationOptions"),S(I)};O.useEffect(()=>{p==="addresses"&&(l!=null&&l.length)&&S(c())},[l,p]),O.useEffect(()=>{p!==""&&s("applicant.locationOptions")},[p]),O.useEffect(()=>{p==="areas"&&(i?(a("applicant.locationOptions",i.map(y=>y.value)),M(i)):a("applicant.locationOptions",[]))},[p,i]),O.useEffect(()=>{if(!(E!=null&&E._embedded))return;let y=E._embedded.filter(I=>!(i!=null&&i.find(v=>v.value===(I==null?void 0:I.id)))).map(I=>({name:I.name??"unnamed area",value:I.id??""}));i!=null&&i.length&&(y=y.concat(i)),M(y)},[E,i]);const L=O.useCallback(y=>{var v,Fe;const I=l??[];if(y.length>I.length){if(!(E!=null&&E._embedded))return;const le=y.find(re=>!I.includes(re)),he={value:le,name:(Fe=(v=E==null?void 0:E._embedded)==null?void 0:v.find(re=>(re==null?void 0:re.id)===le))==null?void 0:Fe.name};a("choosenArea",[...i??[],he])}else{if(y.length==I.length)return;const le=(i==null?void 0:i.filter(he=>y.includes(he.value)))??[];a("choosenArea",le)}},[E,i,l]),F=()=>{a("applicant.locationType","addresses"),a("applicant.locationOptions",N?[N]:[]),setTimeout(()=>{if(_.current){_.current.focus();const y=N.length;_.current.setSelectionRange(y,y)}},0)};return u("div",{"data-testid":Ae,id:Ae,className:"el-mt9",children:[t(k,{"data-testid":"preferred-address-text-title",children:(j=e==null?void 0:e.applicant)==null?void 0:j.preferredAddress}),u(w,{children:[u(T,{className:Ue,"data-testid":"preferred-location-address",children:[p!=="addresses"&&t("div",{"data-testid":"preferred-location-address-mask",className:Ge,onClick:F}),t(oe,{control:n,name:"applicant.locationOptions",render:({field:{value:y,...I}})=>t(R,{children:t(He,{...I,className:Ut,"data-testid":"locationOptions-addresses",ref:_,disabled:p!=="addresses",onChange:b,type:"text",placeholder:"Type Preferred Address*",defaultValue:N})})}),t(W,{message:($=(Q=r.applicant)==null?void 0:Q.locationOptions)==null?void 0:$.message})]}),t(Yt,{onPreClick:()=>{a("applicant.locationType","areas"),a("applicant.locationOptions",[],{shouldDirty:!!(i!=null&&i.length)})},sectionTestId:"preferred-location-area",onPreSelectFn:L,data:g,name:"applicant.locationOptions",disabled:p!=="areas",onInputChange:m,isLoading:A,errorMessage:(B=(X=r.applicant)==null?void 0:X.locationOptions)==null?void 0:B.message,isSearchResultNotFound:x&&!((V=E._embedded)!=null&&V.length)})]})]})},jt=()=>{const{stepsHeader:e}=ge();return t("div",{"data-testid":"step-two-wrapper",children:u("div",{className:ee(Te,pe),children:[t(de,{hasNoMargin:!0,hasBoldText:!0,"data-testid":"step-two-title",children:e==null?void 0:e.stepTwo}),t(vt,{}),t(Wt,{}),t(qt,{})]})})},Qt=async e=>{try{return(await Se.get(`${Ce.DEPARTMENTS}/G`,{headers:{Authorization:`Bearer ${e.accessToken}`}})).data}catch(n){throw n instanceof Ie?_e(n):new Error(n)}},$t=()=>{const e=ue(),{connectSession:n}=me(e);return xe(["departments"],{queryFn:()=>Qt(n),staleTime:1e3*60*60,enabled:!!n})},Xt=()=>{var f,h,E,A,x,N,S,_;const{tailoredQuestions:e}=H(),{register:n,formState:{errors:a,dirtyFields:r},getValues:s,setValue:d,watch:p}=D(),{data:l}=$t(),i=p("applicant.marketingMode")??"buying",c=(m,b)=>{const L=Oe[m];return b&&(b!=null&&b.length)?b==null?void 0:b.map(F=>({name:L?L[F].split(",")[0]:F,value:F})):[]},g=(f=a==null?void 0:a.applicant)==null?void 0:f.type;O.useEffect(()=>{var m;(m=r.applicant)!=null&&m.marketingMode&&d("applicant.specialFeatures",[],{shouldDirty:!0})},[i]);const M=Oe.SPECIAL_FEATURES[i].map(m=>({name:m,value:m}));return t("div",{"data-testid":"multiselect-section-wrapper",className:ae,children:u(w,{children:[t(Z,{children:u(R,{"data-testid":"type-options-wrapper",className:J,children:[t(K,{noneSelectedLabel:"Please select from the options below*",id:"type-options","data-testid":"type-options",options:c("TYPE",l==null?void 0:l.typeOptions),defaultValues:s("applicant.type"),...n("applicant.type",{setValueAs:m=>G(m)?Array.isArray(m)?m:m.split(","):[]})}),t(Y,{"data-testid":"type-options-text-title",children:(h=e==null?void 0:e.applicant)==null?void 0:h.type}),t(W,{message:g==null?void 0:g.message})]})}),t(Z,{children:u(R,{"data-testid":"situation-options-wrapper",className:J,children:[t(K,{id:"situation-options","data-testid":"situation-options",options:c("SITUATION",l==null?void 0:l.situationOptions),defaultValues:s("applicant.situation"),...n("applicant.situation",{setValueAs:m=>G(m)?Array.isArray(m)?m:m.split(","):[]})}),t(Y,{"data-testid":"situation-options-text-title",children:(E=e==null?void 0:e.applicant)==null?void 0:E.situation})]})}),t(Z,{children:u(R,{"data-testid":"special-features-options-wrapper",className:J,children:[t(K,{id:"special-features-options","data-testid":"special-features-options",options:M,defaultValues:s("applicant.specialFeatures"),...n("applicant.specialFeatures",{setValueAs:m=>G(m)?Array.isArray(m)?m:m.split(","):[]})}),t(Y,{"data-testid":"special-features-options-text-title",children:(A=e==null?void 0:e.applicant)==null?void 0:A.specialFeatures})]})}),t(Z,{children:u(R,{"data-testid":"style-options-wrapper",className:J,children:[t(K,{id:"style-options","data-testid":"style-options",options:c("STYLE",l==null?void 0:l.styleOptions),defaultValues:s("applicant.style"),...n("applicant.style",{setValueAs:m=>G(m)?Array.isArray(m)?m:m.split(","):[]})}),t(Y,{"data-testid":"style-options-text-title",children:(x=e==null?void 0:e.applicant)==null?void 0:x.style})]})}),t(Z,{children:u(R,{"data-testid":"age-options-wrapper",className:J,children:[t(K,{id:"age-options","data-testid":"age-options",options:c("AGE",l==null?void 0:l.ageOptions),defaultValues:s("applicant.age"),...n("applicant.age",{setValueAs:m=>G(m)?Array.isArray(m)?m:m.split(","):[]})}),t(Y,{"data-testid":"age-options-text-title",children:(N=e==null?void 0:e.applicant)==null?void 0:N.age})]})}),t(Z,{children:u(R,{"data-testid":"parking-options-wrapper",className:J,children:[t(K,{id:"parking-options","data-testid":"parking-options",options:c("PARKING",l==null?void 0:l.parkingOptions),defaultValues:s("applicant.parking"),...n("applicant.parking",{setValueAs:m=>G(m)?Array.isArray(m)?m:m.split(","):[]})}),t(Y,{"data-testid":"parking-options-text-title",children:(S=e==null?void 0:e.applicant)==null?void 0:S.parking})]})}),t(Z,{children:u(R,{"data-testid":"locality-options-wrapper",className:J,children:[t(K,{id:"locality-options","data-testid":"locality-options",options:c("LOCALITY",l==null?void 0:l.localityOptions),defaultValues:s("applicant.locality"),...n("applicant.locality",{setValueAs:m=>G(m)?Array.isArray(m)?m:m.split(","):[]})}),t(Y,{"data-testid":"locality-options-text-title",children:(_=e==null?void 0:e.applicant)==null?void 0:_.locality})]})})]})})},Kt=()=>{var i,c,g,M,f,h,E,A,x,N,S,_,m;const{tailoredQuestions:e}=H(),{control:n,register:a,formState:{errors:r},trigger:s}=D(),d=async()=>{await s(["applicant.externalArea.amountFrom","applicant.externalArea.amountTo"])},p=async()=>{await s(["applicant.internalArea.type","applicant.internalArea.amount"])},l=b=>{const F=b.target.value.replace(Ve,"");return b.target.value=F,F||""};return u("div",{"data-testid":"property-size-wrapper",className:"el-mt9",children:[t(k,{"data-testid":"property-size-text-title",children:(i=e==null?void 0:e.applicant)==null?void 0:i.size}),u(w,{children:[t(ne,{control:n,labelMin:"Acre From",labelMax:"Acre To",placeholderMin:"Minimum size of Acre",placeholderMax:"Maximum size of Acre",onChangeTransformMax:l,onChangeTransformMin:l,nameMin:"applicant.externalArea.amountFrom",nameMax:"applicant.externalArea.amountTo","data-testidMin":"property-size-field-min","data-testidMax":"property-size-field-max","data-testidDivider":"property-size-text-divider",onChangeMin:d,onChangeMax:d,errorMessageMin:(M=(g=(c=r.applicant)==null?void 0:c.externalArea)==null?void 0:g.amountFrom)==null?void 0:M.message,errorMessageMax:(E=(h=(f=r==null?void 0:r.applicant)==null?void 0:f.externalArea)==null?void 0:h.amountTo)==null?void 0:E.message}),t(T,{children:u(R,{children:[t(Y,{children:"Internal Area Unit"}),u(q,{"data-testid":"property-size-field-internal-type",...a("applicant.internalArea.type",{setValueAs:b=>b===""?null:b,onChange:p}),children:[t("option",{value:"",children:"Select Unit"}),t("option",{value:"squareFeet",children:"Square Feet"}),t("option",{value:"squareMetres",children:"Square Metres"})]}),t(W,{message:(N=(x=(A=r.applicant)==null?void 0:A.internalArea)==null?void 0:x.type)==null?void 0:N.message})]})}),t(T,{children:t(R,{label:"Internal Area Value","data-testid":"property-size-field-internal-amount",placeholder:"Type Value",...a("applicant.internalArea.amount",{setValueAs:b=>b===""||b===null?null:Number.isFinite(+b)?+b:b,onChange:p}),errorMessage:(m=(_=(S=r.applicant)==null?void 0:S.internalArea)==null?void 0:_.amount)==null?void 0:m.message})})]})]})},Zt=()=>{var d,p,l,i,c,g,M,f,h,E,A,x,N;const{tailoredQuestions:e}=H(),{formState:{errors:n},control:a,trigger:r}=D(),s=async()=>{await r(["applicant.bedroomsMin","applicant.bedroomsMax","applicant.receptionsMin","applicant.receptionsMax","applicant.bathroomsMin","applicant.bathroomsMax"])};return u("div",{"data-testid":"room-section-wrapper",className:ae,children:[u(k,{"data-testid":"room-section-title",children:[" ",(d=e==null?void 0:e.applicant)==null?void 0:d.propertyRooms]}),u(w,{children:[t(ne,{control:a,labelMin:"Bedroom From",labelMax:"Bedroom To",nameMin:"applicant.bedroomsMin",nameMax:"applicant.bedroomsMax",placeholderMin:"Add",placeholderMax:"Add",onChangeMin:()=>s(),onChangeMax:()=>s(),"data-testidMin":"bedrooms-min","data-testidMax":"bedrooms-max",errorMessageMin:(l=(p=n.applicant)==null?void 0:p.bedroomsMin)==null?void 0:l.message,errorMessageMax:(c=(i=n.applicant)==null?void 0:i.bedroomsMax)==null?void 0:c.message}),t(ne,{control:a,labelMin:"Reception Room From",labelMax:"Reception Room To",nameMin:"applicant.receptionsMin",nameMax:"applicant.receptionsMax",placeholderMin:"Add",placeholderMax:"Add",onChangeMin:()=>s(),onChangeMax:()=>s(),"data-testidMin":"receptions-room-min","data-testidMax":"receptions-room-max",errorMessageMin:(M=(g=n.applicant)==null?void 0:g.receptionsMin)==null?void 0:M.message,errorMessageMax:(h=(f=n.applicant)==null?void 0:f.receptionsMax)==null?void 0:h.message}),t(ne,{control:a,labelMin:"Bathroom From",labelMax:"Bathroom To",nameMin:"applicant.bathroomsMin",nameMax:"applicant.bathroomsMax",placeholderMin:"Add",placeholderMax:"Add",onChangeMin:()=>s(),onChangeMax:()=>s(),"data-testidMin":"bathrooms-min","data-testidMax":"bathrooms-max",errorMessageMin:(A=(E=n.applicant)==null?void 0:E.bathroomsMin)==null?void 0:A.message,errorMessageMax:(N=(x=n.applicant)==null?void 0:x.bathroomsMax)==null?void 0:N.message})]})]})};function Jt(){var E,A,x,N,S,_,m,b,L,F,j,Q,$,X,B;const{tailoredQuestions:e}=H(),{register:n,control:a,watch:r,resetField:s,trigger:d,formState:{errors:p},setValue:l}=D(),i=r("applicant.marketingMode"),c=r("applicant.buying.tenure"),g=r("applicant.renting.term"),M=()=>{s("applicant.buying.leaseRemaining",{defaultValue:{max:void 0,min:void 0}})};te.useEffect(()=>{if(i==="renting"){s("applicant.buying.tenure"),M();return}else{s("applicant.renting.term");return}},[i]),te.useEffect(()=>{i==="buying"&&c&&!(c!=null&&c.includes("leasehold"))&&M()},[c]);const f=()=>{d(["applicant.buying.leaseRemaining.min","applicant.buying.leaseRemaining.max"])},h=V=>{const I=V.target.value.replace(Ve,"");return V.target.value=I,I||""};return u("div",{"data-testid":"tenure-section-wrapper",className:ae,children:[t(k,{"data-testid":"tenure-text-title",hasNoMargin:(c==null?void 0:c.includes("leasehold"))&&i!=="renting",children:(E=e==null?void 0:e.applicant)==null?void 0:E.tenure}),u(w,{children:[!!i&&(i==="buying"?ke[i].map(({value:V,label:y})=>t(Be,{children:te.createElement(R,{...n("applicant.buying.tenure"),id:`tenure-${V}`,label:y,key:V,value:V,"data-testid":`tenure.${V}`,type:"checkbox"})},V)):t(en,{rentingTenure:g,setValue:l})),i==="buying"&&c&&(c==null?void 0:c.includes("leasehold"))&&t(ne,{control:a,minMax:0,minMin:0,nameMin:"applicant.buying.leaseRemaining.min",nameMax:"applicant.buying.leaseRemaining.max",onChangeTransformMax:h,onChangeTransformMin:h,placeholderMin:"Remaining lease from (years)",placeholderMax:"Remaining lease to (years)",onChangeMax:f,onChangeMin:f,"data-testidMin":"lease-remaining-min","data-testidMax":"lease-remaining-max",errorMessageMin:(S=(N=(x=(A=p.applicant)==null?void 0:A.buying)==null?void 0:x.leaseRemaining)==null?void 0:N.max)==null?void 0:S.message,errorMessageMax:(L=(b=(m=(_=p.applicant)==null?void 0:_.buying)==null?void 0:m.leaseRemaining)==null?void 0:b.min)==null?void 0:L.message})]}),i==="buying"?t(W,{message:(Q=(j=(F=p.applicant)==null?void 0:F.buying)==null?void 0:j.tenure)==null?void 0:Q.message}):t(W,{message:(B=(X=($=p.applicant)==null?void 0:$.renting)==null?void 0:X.term)==null?void 0:B.message})]})}const en=({rentingTenure:e,setValue:n})=>{var l;const{formData:a}=Tt(),r=a?(l=a.applicant.renting)==null?void 0:l.term:e,{watch:s,control:d}=ht({defaultValues:{term:r==="short"?["short"]:r==="long"?["long"]:r==="any"?["short","long"]:""}}),p=s("term");return te.useEffect(()=>{n("applicant.renting.term",G(p)?p.includes("short")&&p.includes("long")?"any":p.toString():"",{shouldDirty:!0})},[p]),t(ce,{children:ke.renting.map(({value:i,label:c})=>t(oe,{control:d,name:"term",render:({field:g})=>t(Be,{children:t(R,{id:`tenure-${i}`,label:c,value:i,checked:Array.isArray(g.value)&&g.value.some(M=>M===i),"data-testid":`tenure.${i}`,onChange:M=>{M.target.checked?Array.isArray(g.value)?g.onChange([...g.value,M.target.value]):g.onChange([M.target.value]):Array.isArray(g.value)?g.onChange(g.value.filter(f=>f!==M.target.value)):g.onChange("")},type:"checkbox"})},i)},i))})},tn=()=>{const{stepsHeader:e}=ge();return t("div",{"data-testid":"step-three-wrapper",children:u("div",{className:ee(Te,pe),children:[t(de,{hasNoMargin:!0,hasBoldText:!0,"data-testid":"step-three-title",children:e==null?void 0:e.stepThree}),t(Xt,{}),t(Zt,{}),t(Jt,{}),t(Kt,{})]})})},nn=()=>{var a;const{tailoredQuestions:e}=H(),{register:n}=D();return u("div",{"data-testid":"note-section-wrapper",className:ae,children:[t(k,{"data-testid":"note-section-title",children:(a=e==null?void 0:e.applicant)==null?void 0:a.notes}),t(w,{children:t(Z,{children:t(R,{children:t(He,{type:"text",placeholder:"Add Notes",...n("applicant.notes")})})})})]})},qe=e=>{const n=Object.values(e);return!(n!=null&&n.length)||Object.prototype.hasOwnProperty.call(n[0],"ref")&&!n[0].ref?!1:n[0].ref?n[0]:qe(n[0])},be=e=>{const n=Array.isArray(e)?e:Object.values(e);for(let a=0;a<n.length;a++)if(n[a]!==null&&typeof n[a]=="object"||Array.isArray(n[a])){if(be(n[a]))return!0}else if(n[a])return!0;return!1},an=e=>{var n,a,r,s,d,p,l,i,c;return(n=e==null?void 0:e.applicant)!=null&&n.bedroomsMax&&((a=e==null?void 0:e.applicant)==null?void 0:a.bedroomsMin)>((r=e==null?void 0:e.applicant)==null?void 0:r.bedroomsMax)&&(e.applicant.bedroomsMax=e==null?void 0:e.applicant.bedroomsMin),(s=e==null?void 0:e.applicant)!=null&&s.bathroomsMax&&((d=e==null?void 0:e.applicant)==null?void 0:d.bathroomsMin)>((p=e==null?void 0:e.applicant)==null?void 0:p.bathroomsMax)&&(e.applicant.bathroomsMax=e==null?void 0:e.applicant.bathroomsMin),(l=e==null?void 0:e.applicant)!=null&&l.receptionsMax&&((i=e==null?void 0:e.applicant)==null?void 0:i.receptionsMin)>((c=e==null?void 0:e.applicant)==null?void 0:c.receptionsMax)&&(e.applicant.receptionsMax=e==null?void 0:e.applicant.receptionsMin),e},rn=()=>{const{formState:{errors:e,dirtyFields:n},handleSubmit:a}=D(),{stepsHeader:r}=ge(),{setPrevLocation:s,setFormData:d,setFormDirtyState:p}=xt(),l=pt(),{pathname:i}=dt(),c=i==="/registration",g=f=>{s(c?"new-registration":"update-registration"),d(an(f)),p({isContactFormSchemaDirty:be((n==null?void 0:n.contact)??{}),isApplicantFormSchemaDirty:be((n==null?void 0:n.applicant)??{})}),l(It.SUMMARY,{state:St.REGISTRATION_TO_SUMMARY})},M=()=>{var E,A,x,N;const f=qe(e),h=document.getElementById("page-container");if((E=e.applicant)!=null&&E.locationOptions){const S=document.getElementById(Ae);h.scrollTo(0,S.offsetTop-window.innerHeight/2),(A=S.querySelector("textarea"))==null||A.focus(),(x=S.querySelector("input"))==null||x.focus();return}(N=f==null?void 0:f.ref)!=null&&N.parentElement&&h.scrollTo(0,f.ref.parentElement.offsetTop-window.innerHeight/2)};return t("div",{"data-testid":"step-four-wrapper",children:u("div",{className:ee(pe),children:[t(de,{hasNoMargin:!0,hasBoldText:!0,"data-testid":"step-four-title",children:r==null?void 0:r.stepFour}),t(nn,{}),t(Xe,{className:Ke,children:u(Ze,{intent:"primary",onClick:a(g,M),"data-testid":"step-four-button",children:[c?"Create":"Update"," Applicant"]})}),t(_t,{})]})})},Sn=[{item:"1",content:t(Bt,{})},{item:"2",content:t(jt,{})},{item:"3",content:t(tn,{})},{item:"4",content:t(rn,{})}],sn={1:{NEXT_STEP:"2",NEEDS_TO_BE_CHECKED_FIELDS:["contact.title","contact.forename","contact.surname","contact.email","contact.mobilePhone","contact.workPhone","contact.homePhone","contact.primaryAddress.postcode","applicant.marketingMode"],REQUIRED_FIELDS:["contact.title","contact.forename","contact.surname","contact.email","contact.primaryAddress.postcode","applicant.marketingMode"]},2:{NEXT_STEP:"3",NEEDS_TO_BE_CHECKED_FIELDS:["applicant.locationType","applicant.locationOptions","applicant.buying.priceTo","applicant.buying.priceFrom","applicant.renting.rentTo","applicant.renting.rentFrom","applicant.renting.rentFrequency"],REQUIRED_FIELDS:["applicant.locationType","applicant.locationOptions"]},3:{NEXT_STEP:"4",NEEDS_TO_BE_CHECKED_FIELDS:["applicant.type","applicant.bedroomsMin","applicant.bedroomsMax","applicant.receptionsMin","applicant.receptionsMax","applicant.bathroomsMin","applicant.bathroomsMax"],REQUIRED_FIELDS:["applicant.type"]},4:{NEXT_STEP:null,NEEDS_TO_BE_CHECKED_FIELDS:[],REQUIRED_FIELDS:[]}},Cn=e=>async n=>{const{name:a}=(n==null?void 0:n.target)??{},{stepState:[r,s],getValues:d,trigger:p}=e,l=sn[+r];if(!G(l)||!G(a))return;const{NEEDS_TO_BE_CHECKED_FIELDS:i,NEXT_STEP:c,REQUIRED_FIELDS:g}=l,M=i.slice(0,i.indexOf(a)+1),f=await p(M),h=d(g);let E=!0;for(let A=0;A<h.length;A++)if(!G(h[A])){E=!1;break}f&&E&&await p(i)&&c&&s(c)};const Fn="ar42ajb",Dn="sebl4gh";function Ln({currentStep:e,totalStep:n}){const a=Math.ceil(e/n*100);return u(Je,{children:[u(et,{style:{width:`${a}%`,transitionDuration:"0.7s"},children:[t(ie,{className:tt}),t(ie,{className:nt}),t(ie,{className:at}),t(ie,{className:rt}),t(ie,{className:it})]}),u(st,{"data-testid":"progress-bar-label",className:ot,children:[a,"%"]})]})}export{_n as A,Ln as F,Dn as S,$t as a,Fn as b,In as c,Sn as s,kt as u,Cn as v};
